
function cm = curl(n, opt_interp)
% Colormap: curl

%-- Parse inputs ---------------------------------------------------------%
if ~exist('n', 'var'); n = []; end
if isempty(n)
   f = get(groot,'CurrentFigure');
   if isempty(f)
      n = size(get(groot,'DefaultFigureColormap'),1);
   else
      n = size(f.Colormap,1);
   end
end

% by default, interpolate in rgb space
if ~exist('opt_interp','var'); opt_interp = []; end
if isempty(opt_interp); opt_interp = 'rgb'; end
%-------------------------------------------------------------------------%

% Data for colormap:
cm = [
  	0.082256	0.114924	0.26479
  	0.084005	0.123123	0.268961
  	0.085751	0.131164	0.273186
  	0.087485	0.139072	0.277459
  	0.089203	0.146865	0.281774
  	0.090899	0.15456	0.286128
  	0.092565	0.16217	0.290516
  	0.094195	0.169708	0.294935
  	0.095781	0.177183	0.299381
  	0.09732	0.184603	0.303854
  	0.098807	0.191977	0.308349
  	0.100235	0.199309	0.312866
  	0.101593	0.206609	0.317399
  	0.102878	0.213879	0.321949
  	0.104087	0.221124	0.326512
  	0.105212	0.22835	0.331088
  	0.10624	0.23556	0.33567
  	0.107171	0.242758	0.340259
  	0.108002	0.249946	0.344853
  	0.108715	0.25713	0.349446
  	0.109313	0.26431	0.354038
  	0.10979	0.271488	0.358625
  	0.110131	0.27867	0.363204
  	0.110341	0.285853	0.367773
  	0.110403	0.293043	0.372326
  	0.11032	0.30024	0.376863
  	0.110081	0.307446	0.381379
  	0.109682	0.314662	0.385871
  	0.109119	0.321888	0.390335
  	0.108385	0.329127	0.394768
  	0.107475	0.336379	0.399165
  	0.106393	0.343644	0.403525
  	0.105119	0.350925	0.407839
  	0.103671	0.358218	0.412108
  	0.102034	0.365527	0.416326
  	0.100209	0.37285	0.420488
  	0.098208	0.380187	0.424591
  	0.096033	0.387538	0.428631
  	0.093679	0.394903	0.432601
  	0.09117	0.40228	0.436498
  	0.088524	0.409669	0.440318
  	0.085762	0.417068	0.444057
  	0.082915	0.424476	0.447709
  	0.080027	0.431891	0.451269
  	0.07715	0.439312	0.454733
  	0.074357	0.446735	0.458097
  	0.071737	0.454159	0.461354
  	0.069402	0.46158	0.464502
  	0.067485	0.468995	0.467535
  	0.06614	0.4764	0.470451
  	0.06552	0.483792	0.473243
  	0.065812	0.491165	0.47591
  	0.067178	0.498514	0.478452
  	0.069734	0.505835	0.480861
  	0.073593	0.513119	0.483144
  	0.078778	0.520363	0.485296
  	0.085293	0.527557	0.487323
  	0.093082	0.534696	0.48923
  	0.102066	0.541771	0.491022
  	0.112148	0.548775	0.49271
  	0.123221	0.555701	0.494307
  	0.135179	0.562542	0.495829
  	0.147916	0.56929	0.497294
  	0.161331	0.575941	0.498723
  	0.175326	0.582491	0.500141
  	0.189809	0.588936	0.501575
  	0.204694	0.595275	0.50305
  	0.219898	0.601509	0.504595
  	0.235346	0.607639	0.506237
  	0.250969	0.613669	0.508001
  	0.266704	0.619604	0.509912
  	0.282497	0.625449	0.51199
  	0.2983	0.631211	0.514254
  	0.314074	0.636897	0.516719
  	0.329787	0.642516	0.5194
  	0.345412	0.648073	0.522305
  	0.360928	0.653577	0.525442
  	0.376319	0.659035	0.528819
  	0.391573	0.664454	0.532438
  	0.406682	0.66984	0.536303
  	0.42164	0.6752	0.540414
  	0.436445	0.68054	0.544772
  	0.451096	0.685865	0.549376
  	0.46559	0.691181	0.554226
  	0.479931	0.696491	0.559318
  	0.49412	0.701802	0.564651
  	0.50816	0.707117	0.570223
  	0.522052	0.71244	0.57603
  	0.535803	0.717775	0.582069
  	0.549412	0.723126	0.588338
  	0.562887	0.728495	0.594831
  	0.576227	0.733887	0.601547
  	0.589438	0.739305	0.60848
  	0.602526	0.74475	0.615627
  	0.615492	0.750226	0.622984
  	0.62834	0.755736	0.630546
  	0.641071	0.761283	0.638311
  	0.653692	0.766868	0.646272
  	0.666206	0.772494	0.654427
  	0.678615	0.778163	0.66277
  	0.690923	0.783877	0.671297
  	0.703133	0.789639	0.680003
  	0.715249	0.795451	0.688885
  	0.727273	0.801314	0.697936
  	0.739209	0.80723	0.707154
  	0.751058	0.813201	0.716532
  	0.762823	0.81923	0.726065
  	0.774509	0.825317	0.73575
  	0.786119	0.831464	0.745581
  	0.797655	0.837673	0.755555
  	0.809118	0.843946	0.765663
  	0.820513	0.850283	0.775903
  	0.831843	0.856687	0.78627
  	0.843109	0.863159	0.796756
  	0.854315	0.8697	0.807358
  	0.865465	0.876311	0.818071
  	0.87656	0.882994	0.828885
  	0.887607	0.889749	0.839799
  	0.898607	0.896579	0.850801
  	0.909571	0.90348	0.86189
  	0.920501	0.910455	0.873055
  	0.931413	0.917499	0.884296
  	0.942317	0.92461	0.895613
  	0.953232	0.931779	0.907026
  	0.964157	0.939003	0.918588
  	0.97503	0.9463	0.930393
  	0.985693	0.953728	0.942499
  	0.996024	0.961359	0.954732
  	0.992947	0.962495	0.955943
  	0.987975	0.952741	0.942976
  	0.983173	0.943003	0.929886
  	0.97853	0.933275	0.916727
  	0.974037	0.923555	0.903531
  	0.969687	0.913844	0.890314
  	0.965471	0.904139	0.877095
  	0.961379	0.894441	0.863887
  	0.957409	0.884748	0.850698
  	0.953554	0.875059	0.837536
  	0.94981	0.865374	0.824409
  	0.94617	0.855691	0.811325
  	0.942627	0.84601	0.798293
  	0.939181	0.836329	0.785318
  	0.935829	0.826647	0.772402
  	0.93256	0.816963	0.759559
  	0.929373	0.807277	0.746792
  	0.926268	0.797585	0.734104
  	0.923231	0.78789	0.721509
  	0.920267	0.778187	0.709007
  	0.917368	0.768477	0.696608
  	0.914526	0.758759	0.684322
  	0.911745	0.749031	0.672149
  	0.909009	0.739294	0.660107
  	0.906326	0.729543	0.648192
  	0.90368	0.719783	0.636424
  	0.901073	0.710009	0.624804
  	0.898498	0.700222	0.613344
  	0.895945	0.690423	0.602055
  	0.893417	0.680608	0.590943
  	0.890901	0.67078	0.580022
  	0.88839	0.66094	0.569303
  	0.885886	0.651085	0.558793
  	0.883376	0.641217	0.548506
  	0.880853	0.631338	0.538455
  	0.87831	0.621448	0.52865
  	0.87574	0.61155	0.519103
  	0.873135	0.601644	0.509827
  	0.87049	0.591733	0.500832
  	0.867793	0.581819	0.49213
  	0.865037	0.571906	0.483734
  	0.862213	0.561997	0.475652
  	0.859313	0.552096	0.467895
  	0.856328	0.542207	0.46047
  	0.853249	0.532335	0.453387
  	0.850068	0.522485	0.44665
  	0.846777	0.512661	0.440265
  	0.843369	0.50287	0.434233
  	0.839835	0.493116	0.428556
  	0.836172	0.483405	0.423232
  	0.832372	0.473743	0.41826
  	0.828429	0.464134	0.413633
  	0.824341	0.454585	0.409346
  	0.820104	0.445099	0.405391
  	0.815715	0.435682	0.401757
  	0.811172	0.426337	0.398433
  	0.806476	0.417069	0.395408
  	0.801625	0.40788	0.392667
  	0.79662	0.398773	0.390198
  	0.791463	0.389752	0.387986
  	0.786154	0.380817	0.386017
  	0.780698	0.371971	0.384275
  	0.775095	0.363214	0.382746
  	0.769348	0.354548	0.381416
  	0.763462	0.345973	0.38027
  	0.757439	0.337489	0.379295
  	0.751282	0.329097	0.378478
  	0.744994	0.320796	0.377804
  	0.73858	0.312585	0.377262
  	0.732043	0.304465	0.376841
  	0.725384	0.296435	0.376528
  	0.718609	0.288495	0.376312
  	0.711719	0.280644	0.376184
  	0.704718	0.272882	0.376133
  	0.697608	0.265208	0.376149
  	0.690391	0.257622	0.376223
  	0.683069	0.250125	0.376347
  	0.675645	0.242717	0.376511
  	0.66812	0.235397	0.376707
  	0.660495	0.228168	0.376926
  	0.652773	0.22103	0.377161
  	0.644952	0.213984	0.377402
  	0.637036	0.207034	0.377641
  	0.629023	0.200182	0.37787
  	0.620914	0.19343	0.37808
  	0.612709	0.186784	0.37826
  	0.604409	0.180248	0.378404
  	0.596011	0.173827	0.378499
  	0.587516	0.167529	0.378536
  	0.578924	0.161361	0.378504
  	0.570232	0.155332	0.37839
  	0.56144	0.149452	0.378181
  	0.552547	0.143732	0.377866
  	0.543551	0.138183	0.377427
  	0.534452	0.132821	0.376851
  	0.525249	0.127657	0.376121
  	0.515941	0.122708	0.375218
  	0.506528	0.117987	0.374126
  	0.497009	0.11351	0.372824
  	0.487388	0.10929	0.371294
  	0.477664	0.105338	0.369515
  	0.467841	0.101664	0.367468
  	0.457922	0.098273	0.365134
  	0.447914	0.095165	0.362495
  	0.437822	0.092337	0.359536
  	0.427654	0.089778	0.356242
  	0.417418	0.087475	0.352605
  	0.407126	0.085405	0.348615
  	0.396786	0.083544	0.34427
  	0.386409	0.081864	0.33957
  	0.376009	0.080328	0.334517
  	0.365596	0.078909	0.329121
  	0.355179	0.077573	0.323392
  	0.34477	0.076285	0.317343
  	0.334381	0.075015	0.310988
  	0.324017	0.073736	0.304346
  	0.313687	0.072424	0.297433
  	0.303397	0.071056	0.29027
  	0.293152	0.069612	0.282873
  	0.282957	0.068078	0.27526
  	0.272815	0.066439	0.267451
  	0.262728	0.064683	0.25946
  	0.252701	0.062796	0.251307
  	0.24273	0.060776	0.243003
  	0.232814	0.05862	0.234561
  	0.222957	0.056316	0.225997
  	0.213154	0.05386	0.21732
  	0.2034	0.051257	0.208537
];

%-- Modify the colormap by interpolation ---------------------------------%
%   Note: Interpolation can be done in hsv or rgb space depending on opt_interp.
p = size(cm,1); % default size of colormap
if strcmp(opt_interp, 'hsv')
    hsv = rgb2hsv(cm);
    hsv = interp1(1:p, hsv, linspace(1,p,n), 'linear');
    cm = hsv2rgb(hsv);
elseif strcmp(opt_interp, 'none') % do nothing
else
    cm = interp1(1:p, cm, linspace(1,p,n), 'linear');
end

end
