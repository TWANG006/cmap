
function cm = nuclear(n, opt_interp)
% Colormap: nuclear
% Source:   CMasher
% Authors:	Ellert van der Velden

%-- Parse inputs ---------------------------------------------------------%
if ~exist('n', 'var'); n = []; end
if isempty(n)
   f = get(groot,'CurrentFigure');
   if isempty(f)
      n = size(get(groot,'DefaultFigureColormap'),1);
   else
      n = size(f.Colormap,1);
   end
end

% by default, interpolate in rgb space
if ~exist('opt_interp','var'); opt_interp = []; end
if isempty(opt_interp); opt_interp = 'rgb'; end
%-------------------------------------------------------------------------%


% data for colormap
cm = [
    0.000000	0.000000	0.000000
    0.000219	0.000178	0.000256
    0.000768	0.000609	0.000925
    0.001607	0.001248	0.001996
    0.002720	0.002074	0.003475
    0.004097	0.003071	0.005378
    0.005730	0.004231	0.007722
    0.007614	0.005543	0.010528
    0.009743	0.007002	0.013816
    0.012114	0.008602	0.017609
    0.014722	0.010338	0.021932
    0.017564	0.012204	0.026808
    0.020635	0.014199	0.032265
    0.023932	0.016317	0.038330
    0.027451	0.018556	0.044814
    0.031189	0.020913	0.051320
    0.035140	0.023385	0.057855
    0.039301	0.025970	0.064424
    0.043542	0.028666	0.071033
    0.047710	0.031471	0.077685
    0.051818	0.034383	0.084384
    0.055867	0.037400	0.091133
    0.059858	0.040520	0.097934
    0.063792	0.043617	0.104791
    0.067668	0.046674	0.111706
    0.071488	0.049696	0.118681
    0.075250	0.052683	0.125718
    0.078955	0.055639	0.132820
    0.082600	0.058566	0.139987
    0.086186	0.061466	0.147221
    0.089711	0.064341	0.154524
    0.093172	0.067194	0.161896
    0.096568	0.070027	0.169337
    0.099895	0.072843	0.176849
    0.103151	0.075644	0.184432
    0.106331	0.078434	0.192084
    0.109432	0.081216	0.199805
    0.112448	0.083993	0.207594
    0.115375	0.086770	0.215448
    0.118204	0.089551	0.223364
    0.120931	0.092341	0.231337
    0.123544	0.095147	0.239364
    0.126036	0.097974	0.247435
    0.128395	0.100830	0.255544
    0.130608	0.103725	0.263677
    0.132661	0.106668	0.271820
    0.134539	0.109670	0.279955
    0.136222	0.112745	0.288060
    0.137692	0.115908	0.296105
    0.138928	0.119174	0.304055
    0.139905	0.122561	0.311868
    0.140604	0.126089	0.319492
    0.141003	0.129773	0.326868
    0.141089	0.133631	0.333930
    0.140855	0.137673	0.340608
    0.140306	0.141903	0.346835
    0.139461	0.146318	0.352557
    0.138353	0.150901	0.357733
    0.137026	0.155631	0.362348
    0.135530	0.160477	0.366409
    0.133917	0.165410	0.369945
    0.132235	0.170399	0.372997
    0.130528	0.175417	0.375616
    0.128831	0.180442	0.377853
    0.127174	0.185454	0.379761
    0.125580	0.190441	0.381387
    0.124067	0.195393	0.382772
    0.122649	0.200303	0.383954
    0.121337	0.205165	0.384967
    0.120138	0.209979	0.385836
    0.119058	0.214741	0.386587
    0.118101	0.219452	0.387241
    0.117269	0.224113	0.387814
    0.116562	0.228724	0.388321
    0.115980	0.233287	0.388774
    0.115523	0.237803	0.389186
    0.115187	0.242276	0.389565
    0.114970	0.246706	0.389919
    0.114869	0.251096	0.390255
    0.114879	0.255449	0.390578
    0.114995	0.259765	0.390894
    0.115213	0.264049	0.391207
    0.115526	0.268301	0.391520
    0.115930	0.272523	0.391836
    0.116417	0.276719	0.392158
    0.116982	0.280889	0.392487
    0.117618	0.285036	0.392826
    0.118318	0.289162	0.393176
    0.119076	0.293268	0.393537
    0.119885	0.297357	0.393911
    0.120739	0.301430	0.394297
    0.121630	0.305488	0.394696
    0.122553	0.309534	0.395108
    0.123501	0.313569	0.395532
    0.124468	0.317593	0.395968
    0.125447	0.321610	0.396416
    0.126432	0.325620	0.396875
    0.127419	0.329625	0.397343
    0.128401	0.333625	0.397820
    0.129373	0.337623	0.398305
    0.130330	0.341619	0.398795
    0.131266	0.345614	0.399290
    0.132178	0.349609	0.399787
    0.133061	0.353606	0.400286
    0.133911	0.357606	0.400784
    0.134723	0.361609	0.401280
    0.135494	0.365616	0.401771
    0.136221	0.369627	0.402255
    0.136901	0.373645	0.402730
    0.137530	0.377669	0.403194
    0.138106	0.381700	0.403645
    0.138627	0.385738	0.404081
    0.139090	0.389785	0.404499
    0.139494	0.393840	0.404896
    0.139836	0.397904	0.405271
    0.140116	0.401977	0.405621
    0.140332	0.406060	0.405945
    0.140484	0.410152	0.406238
    0.140570	0.414255	0.406500
    0.140590	0.418367	0.406728
    0.140544	0.422490	0.406920
    0.140431	0.426623	0.407073
    0.140253	0.430767	0.407185
    0.140009	0.434921	0.407255
    0.139700	0.439085	0.407280
    0.139327	0.443260	0.407258
    0.138891	0.447444	0.407187
    0.138393	0.451639	0.407065
    0.137835	0.455844	0.406891
    0.137218	0.460058	0.406663
    0.136544	0.464281	0.406378
    0.135815	0.468514	0.406036
    0.135034	0.472755	0.405634
    0.134202	0.477006	0.405171
    0.133324	0.481264	0.404646
    0.132401	0.485531	0.404057
    0.131437	0.489806	0.403402
    0.130436	0.494088	0.402681
    0.129401	0.498377	0.401891
    0.128337	0.502674	0.401032
    0.127248	0.506977	0.400102
    0.126139	0.511286	0.399100
    0.125014	0.515601	0.398024
    0.123880	0.519921	0.396875
    0.122741	0.524247	0.395649
    0.121606	0.528578	0.394347
    0.120479	0.532913	0.392966
    0.119370	0.537252	0.391506
    0.118284	0.541596	0.389966
    0.117230	0.545942	0.388344
    0.116217	0.550292	0.386639
    0.115254	0.554645	0.384850
    0.114351	0.559000	0.382975
    0.113517	0.563357	0.381014
    0.112764	0.567716	0.378965
    0.112101	0.572076	0.376827
    0.111541	0.576437	0.374597
    0.111095	0.580799	0.372275
    0.110774	0.585161	0.369860
    0.110591	0.589522	0.367349
    0.110558	0.593884	0.364741
    0.110687	0.598244	0.362035
    0.110989	0.602603	0.359227
    0.111475	0.606959	0.356317
    0.112156	0.611314	0.353303
    0.113042	0.615666	0.350181
    0.114144	0.620015	0.346950
    0.115469	0.624360	0.343608
    0.117025	0.628701	0.340151
    0.118819	0.633038	0.336578
    0.120857	0.637369	0.332884
    0.123143	0.641694	0.329067
    0.125681	0.646013	0.325123
    0.128474	0.650325	0.321049
    0.131523	0.654629	0.316840
    0.134831	0.658925	0.312493
    0.138397	0.663212	0.308002
    0.142221	0.667489	0.303361
    0.146303	0.671755	0.298566
    0.150643	0.676009	0.293611
    0.155240	0.680250	0.288489
    0.160093	0.684478	0.283192
    0.165202	0.688691	0.277711
    0.170567	0.692887	0.272041
    0.176190	0.697065	0.266167
    0.182069	0.701225	0.260082
    0.188209	0.705363	0.253770
    0.194612	0.709478	0.247221
    0.201282	0.713569	0.240417
    0.208225	0.717632	0.233340
    0.215448	0.721664	0.225971
    0.222959	0.725664	0.218288
    0.230770	0.729627	0.210263
    0.238894	0.733549	0.201868
    0.247348	0.737425	0.193068
    0.256153	0.741250	0.183817
    0.265332	0.745018	0.174077
    0.274916	0.748719	0.163784
    0.284940	0.752346	0.152881
    0.295446	0.755887	0.141293
    0.306485	0.759327	0.128940
    0.318120	0.762649	0.115738
    0.330415	0.765833	0.101625
    0.343439	0.768855	0.086604
    0.357252	0.771687	0.070852
    0.371858	0.774306	0.055012
    0.387164	0.776700	0.040729
    0.402911	0.778887	0.031747
    0.418690	0.780923	0.031097
    0.434074	0.782883	0.039037
    0.448767	0.784840	0.053422
    0.462657	0.786838	0.070275
    0.475747	0.788901	0.087739
    0.488113	0.791036	0.105020
    0.499840	0.793241	0.121821
    0.511011	0.795513	0.138060
    0.521703	0.797846	0.153747
    0.531978	0.800235	0.168919
    0.541894	0.802674	0.183630
    0.551489	0.805160	0.197923
    0.560808	0.807688	0.211854
    0.569878	0.810255	0.225456
    0.578731	0.812858	0.238772
    0.587386	0.815493	0.251830
    0.595865	0.818159	0.264657
    0.604184	0.820854	0.277277
    0.612360	0.823576	0.289714
    0.620405	0.826323	0.301985
    0.628327	0.829095	0.314098
    0.636143	0.831888	0.326081
    0.643855	0.834705	0.337930
    0.651476	0.837542	0.349670
    0.659012	0.840399	0.361305
    0.666467	0.843276	0.372839
    0.673850	0.846172	0.384285
    0.681166	0.849086	0.395650
    0.688418	0.852017	0.406939
    0.695611	0.854966	0.418156
    0.702750	0.857932	0.429305
    0.709836	0.860915	0.440393
    0.716875	0.863915	0.451421
    0.723870	0.866931	0.462394
    0.730822	0.869963	0.473316
    0.737735	0.873010	0.484191
    0.744612	0.876074	0.495020
    0.751453	0.879154	0.505801
    0.758261	0.882249	0.516539
    0.765039	0.885360	0.527241
    0.771789	0.888487	0.537905
    0.778510	0.891630	0.548526
    0.785207	0.894788	0.559117
    0.791879	0.897962	0.569673
    0.798527	0.901152	0.580193
    0.805156	0.904357	0.590686
    0.811761	0.907580	0.601141
    0.818351	0.910817	0.611575
   ];


%-- Modify the colormap by interpolation ---------------------------------%
%   Note: Interpolation can be done in hsv or rgb space depending on opt_interp.
p = size(cm,1); % default size of colormap
if strcmp(opt_interp,'hsv')
    hsv = rgb2hsv(cm);
    hsv = interp1(1:p, hsv, linspace(1,p,n), 'linear');
    cm = hsv2rgb(hsv);
else
    cm = interp1(1:p, cm, linspace(1,p,n), 'linear');
end


end
